
// Awesomplete - Lea Verou - MIT license
!function () { function t(t) { var e = Array.isArray(t) ? { label: t[0], value: t[1] } : "object" == typeof t && "label" in t && "value" in t ? t : { label: t, value: t }; this.label = e.label || e.value, this.value = e.value } function e(t, e, i) { for (var n in e) { var s = e[n], r = t.input.getAttribute("data-" + n.toLowerCase()); "number" == typeof s ? t[n] = parseInt(r) : !1 === s ? t[n] = null !== r : s instanceof Function ? t[n] = null : t[n] = r, t[n] || 0 === t[n] || (t[n] = n in i ? i[n] : s) } } function i(t, e) { return "string" == typeof t ? (e || document).querySelector(t) : t || null } function n(t, e) { return o.call((e || document).querySelectorAll(t)) } function s() { n("input.awesomplete").forEach(function (t) { new r(t) }) } var r = function (t, n) { var s = this; this.isOpened = !1, this.input = i(t), this.input.setAttribute("autocomplete", "off"), this.input.setAttribute("aria-autocomplete", "list"), n = n || {}, e(this, { minChars: 2, maxItems: 10, autoFirst: !1, data: r.DATA, filter: r.FILTER_CONTAINS, sort: !1 !== n.sort && r.SORT_BYLENGTH, item: r.ITEM, replace: r.REPLACE }, n), this.index = -1, this.container = i.create("div", { className: "awesomplete", around: t }), this.ul = i.create("ul", { hidden: "hidden", inside: this.container }), this.status = i.create("span", { className: "visually-hidden", role: "status", "aria-live": "assertive", "aria-relevant": "additions", inside: this.container }), this._events = { input: { input: this.evaluate.bind(this), blur: this.close.bind(this, { reason: "blur" }), keydown: function (t) { var e = t.keyCode; s.opened && (13 === e && s.selected ? (t.preventDefault(), s.select()) : 27 === e ? s.close({ reason: "esc" }) : 38 !== e && 40 !== e || (t.preventDefault(), s[38 === e ? "previous" : "next"]())) } }, form: { submit: this.close.bind(this, { reason: "submit" }) }, ul: { mousedown: function (t) { var e = t.target; if (e !== this) { for (; e && !/li/i.test(e.nodeName) ;) e = e.parentNode; e && 0 === t.button && (t.preventDefault(), s.select(e, t.target)) } } } }, i.bind(this.input, this._events.input), i.bind(this.input.form, this._events.form), i.bind(this.ul, this._events.ul), this.input.hasAttribute("list") ? (this.list = "#" + this.input.getAttribute("list"), this.input.removeAttribute("list")) : this.list = this.input.getAttribute("data-list") || n.list || [], r.all.push(this) }; r.prototype = { set list(t) { if (Array.isArray(t)) this._list = t; else if ("string" == typeof t && t.indexOf(",") > -1) this._list = t.split(/\s*,\s*/); else if ((t = i(t)) && t.children) { var e = []; o.apply(t.children).forEach(function (t) { if (!t.disabled) { var i = t.textContent.trim(), n = t.value || i, s = t.label || i; "" !== n && e.push({ label: s, value: n }) } }), this._list = e } document.activeElement === this.input && this.evaluate() }, get selected() { return this.index > -1 }, get opened() { return this.isOpened }, close: function (t) { this.opened && (this.ul.setAttribute("hidden", ""), this.isOpened = !1, this.index = -1, i.fire(this.input, "awesomplete-close", t || {})) }, open: function () { this.ul.removeAttribute("hidden"), this.isOpened = !0, this.autoFirst && -1 === this.index && this.goto(0), i.fire(this.input, "awesomplete-open") }, destroy: function () { i.unbind(this.input, this._events.input), i.unbind(this.input.form, this._events.form); var t = this.container.parentNode; t.insertBefore(this.input, this.container), t.removeChild(this.container), this.input.removeAttribute("autocomplete"), this.input.removeAttribute("aria-autocomplete"); var e = r.all.indexOf(this); -1 !== e && r.all.splice(e, 1) }, next: function () { var t = this.ul.children.length; this.goto(this.index < t - 1 ? this.index + 1 : t ? 0 : -1) }, previous: function () { var t = this.ul.children.length, e = this.index - 1; this.goto(this.selected && -1 !== e ? e : t - 1) }, goto: function (t) { var e = this.ul.children; this.selected && e[this.index].setAttribute("aria-selected", "false"), this.index = t, t > -1 && e.length > 0 && (e[t].setAttribute("aria-selected", "true"), this.status.textContent = e[t].textContent, this.ul.scrollTop = e[t].offsetTop - this.ul.clientHeight + e[t].clientHeight, i.fire(this.input, "awesomplete-highlight", { text: this.suggestions[this.index] })) }, select: function (t, e) { if (t ? this.index = i.siblingIndex(t) : t = this.ul.children[this.index], t) { var n = this.suggestions[this.index]; i.fire(this.input, "awesomplete-select", { text: n, origin: e || t }) && (this.replace(n), this.close({ reason: "select" }), i.fire(this.input, "awesomplete-selectcomplete", { text: n })) } }, evaluate: function () { var e = this, i = this.input.value; i.length >= this.minChars && this._list.length > 0 ? (this.index = -1, this.ul.innerHTML = "", this.suggestions = this._list.map(function (n) { return new t(e.data(n, i)) }).filter(function (t) { return e.filter(t, i) }), !1 !== this.sort && (this.suggestions = this.suggestions.sort(this.sort)), this.suggestions = this.suggestions.slice(0, this.maxItems), this.suggestions.forEach(function (t) { e.ul.appendChild(e.item(t, i)) }), 0 === this.ul.children.length ? this.close({ reason: "nomatches" }) : this.open()) : this.close({ reason: "nomatches" }) } }, r.all = [], r.FILTER_CONTAINS = function (t, e) { return RegExp(i.regExpEscape(e.trim()), "i").test(t) }, r.FILTER_STARTSWITH = function (t, e) { return RegExp("^" + i.regExpEscape(e.trim()), "i").test(t) }, r.SORT_BYLENGTH = function (t, e) { return t.length !== e.length ? t.length - e.length : t < e ? -1 : 1 }, r.ITEM = function (t, e) { return i.create("li", { innerHTML: "" === e.trim() ? t : t.replace(RegExp(i.regExpEscape(e.trim()), "gi"), "<mark>$&</mark>"), "aria-selected": "false" }) }, r.REPLACE = function (t) { this.input.value = t.value }, r.DATA = function (t) { return t }, Object.defineProperty(t.prototype = Object.create(String.prototype), "length", { get: function () { return this.label.length } }), t.prototype.toString = t.prototype.valueOf = function () { return "" + this.label }; var o = Array.prototype.slice; i.create = function (t, e) { var n = document.createElement(t); for (var s in e) { var r = e[s]; if ("inside" === s) i(r).appendChild(n); else if ("around" === s) { var o = i(r); o.parentNode.insertBefore(n, o), n.appendChild(o) } else s in n ? n[s] = r : n.setAttribute(s, r) } return n }, i.bind = function (t, e) { if (t) for (var i in e) { var n = e[i]; i.split(/\s+/).forEach(function (e) { t.addEventListener(e, n) }) } }, i.unbind = function (t, e) { if (t) for (var i in e) { var n = e[i]; i.split(/\s+/).forEach(function (e) { t.removeEventListener(e, n) }) } }, i.fire = function (t, e, i) { var n = document.createEvent("HTMLEvents"); n.initEvent(e, !0, !0); for (var s in i) n[s] = i[s]; return t.dispatchEvent(n) }, i.regExpEscape = function (t) { return t.replace(/[-\\^$*+?.()|[\]{}]/g, "\\$&") }, i.siblingIndex = function (t) { for (var e = 0; t = t.previousElementSibling; e++); return e }, "undefined" != typeof Document && ("loading" !== document.readyState ? s() : document.addEventListener("DOMContentLoaded", s)), r.$ = i, r.$$ = n, "undefined" != typeof self && (self.Awesomplete = r), "object" == typeof module && module.exports && (module.exports = r) }();
// AddyComplete - https://www.addy.co.nz
function AddyComplete(e, t, i) { var s = "https://www.addy.co.nz/", n = this; n.fields = t, i || (i = {}), i.maxResults || (i.maxResults = 10), i.excludePostBox || (i.excludePostBox = !1), i.nzCountryValue || (i.nzCountryValue = "NZL"), i.debounceMs || (i.debounceMs = 250), i.ignoreKeys || (i.ignoreKeys = [38, 40, 13]), n.options = i; var r = new Awesomplete(e, { maxItems: n.options.maxResults, minChars: 3, autoFirst: !0, sort: !1 }); r.filter = function () { return !0 }, n.setUrlBase = function (e) { s = e }, n.debounce = function (e, t) { var i; return function () { var s = this, n = arguments; clearTimeout(i), (i = setTimeout(function () { i = null, e.apply(s, n) }, t)) || e.apply(s, n) } }; var o = function (e, t) { var i = new XMLHttpRequest; i.open("GET", e, !0), i.onload = function () { var e = JSON.parse(i.responseText); t(e) }, i.setRequestHeader("addy-api-key", AddyComplete.apiKey), i.send() }; e.onkeyup = n.debounce(function (e) { -1 !== n.options.ignoreKeys.indexOf(e.keyCode) || this.value.length < r.minChars || (n.fields && n.fields.country && n.fields.country.options[n.fields.country.selectedIndex].value !== n.options.nzCountryValue ? r.list = [] : o(s + "api/search?expostbox=" + n.options.excludePostBox + "&max=" + n.options.maxResults + "&s=" + this.value, function (e) { r.list = e.addresses.map(function (e) { return { label: e.a, value: e.id } }) })) }, n.options.debounceMs); var l = function (e) { n.fields && (n.fields.address && (n.fields.address.value = e.displayline), n.fields.suburb && (n.fields.suburb.value = e.suburb), n.fields.city && (n.fields.city.value = e.city), n.fields.region && (n.fields.region.value = e.region), n.fields.postcode && (n.fields.postcode.value = e.postcode), n.fields.line1 && (n.fields.line1.value = e.address1), n.fields.line2 && (n.fields.line2.value = e.address2), n.fields.line3 && (n.fields.line3.value = e.address3), n.fields.line4 && (n.fields.line4.value = e.address4), n.fields.address1 && n.fields.address2 && (e.address4 || 0 === e.address2.indexOf("RD ") ? (n.fields.address1.value = e.address1, n.fields.address2.value = e.address2) : (n.fields.address1.value = e.displayline, n.fields.address2.value = ""))) }; e.addEventListener("awesomplete-selectcomplete", function (e) { o(s + "api/address/" + e.text.value, function (e) { l(e) }) }, !1) } !function () { function e(e) { var t = Array.isArray(e) ? { label: e[0], value: e[1] } : "object" == typeof e && "label" in e && "value" in e ? e : { label: e, value: e }; this.label = t.label || t.value, this.value = t.value } function t(e, t, i) { for (var s in t) { var n = t[s], r = e.input.getAttribute("data-" + s.toLowerCase()); "number" == typeof n ? e[s] = parseInt(r) : !1 === n ? e[s] = null !== r : n instanceof Function ? e[s] = null : e[s] = r, e[s] || 0 === e[s] || (e[s] = s in i ? i[s] : n) } } function i(e, t) { return "string" == typeof e ? (t || document).querySelector(e) : e || null } function s(e, t) { return o.call((t || document).querySelectorAll(e)) } function n() { s("input.awesomplete").forEach(function (e) { new r(e) }) } var r = function (e, s) { var n = this; this.isOpened = !1, this.input = i(e), this.input.setAttribute("autocomplete", "off"), this.input.setAttribute("aria-autocomplete", "list"), s = s || {}, t(this, { minChars: 2, maxItems: 10, autoFirst: !1, data: r.DATA, filter: r.FILTER_CONTAINS, sort: !1 !== s.sort && r.SORT_BYLENGTH, item: r.ITEM, replace: r.REPLACE }, s), this.index = -1, this.container = i.create("div", { className: "awesomplete", around: e }), this.ul = i.create("ul", { hidden: "hidden", inside: this.container }), this.status = i.create("span", { className: "visually-hidden", role: "status", "aria-live": "assertive", "aria-relevant": "additions", inside: this.container }), this._events = { input: { input: this.evaluate.bind(this), blur: this.close.bind(this, { reason: "blur" }), keydown: function (e) { var t = e.keyCode; n.opened && (13 === t && n.selected ? (e.preventDefault(), n.select()) : 27 === t ? n.close({ reason: "esc" }) : 38 !== t && 40 !== t || (e.preventDefault(), n[38 === t ? "previous" : "next"]())) } }, form: { submit: this.close.bind(this, { reason: "submit" }) }, ul: { mousedown: function (e) { var t = e.target; if (t !== this) { for (; t && !/li/i.test(t.nodeName) ;) t = t.parentNode; t && 0 === e.button && (e.preventDefault(), n.select(t, e.target)) } } } }, i.bind(this.input, this._events.input), i.bind(this.input.form, this._events.form), i.bind(this.ul, this._events.ul), this.input.hasAttribute("list") ? (this.list = "#" + this.input.getAttribute("list"), this.input.removeAttribute("list")) : this.list = this.input.getAttribute("data-list") || s.list || [], r.all.push(this) }; r.prototype = { set list(e) { if (Array.isArray(e)) this._list = e; else if ("string" == typeof e && e.indexOf(",") > -1) this._list = e.split(/\s*,\s*/); else if ((e = i(e)) && e.children) { var t = []; o.apply(e.children).forEach(function (e) { if (!e.disabled) { var i = e.textContent.trim(), s = e.value || i, n = e.label || i; "" !== s && t.push({ label: n, value: s }) } }), this._list = t } document.activeElement === this.input && this.evaluate() }, get selected() { return this.index > -1 }, get opened() { return this.isOpened }, close: function (e) { this.opened && (this.ul.setAttribute("hidden", ""), this.isOpened = !1, this.index = -1, i.fire(this.input, "awesomplete-close", e || {})) }, open: function () { this.ul.removeAttribute("hidden"), this.isOpened = !0, this.autoFirst && -1 === this.index && this.goto(0), i.fire(this.input, "awesomplete-open") }, destroy: function () { i.unbind(this.input, this._events.input), i.unbind(this.input.form, this._events.form); var e = this.container.parentNode; e.insertBefore(this.input, this.container), e.removeChild(this.container), this.input.removeAttribute("autocomplete"), this.input.removeAttribute("aria-autocomplete"); var t = r.all.indexOf(this); -1 !== t && r.all.splice(t, 1) }, next: function () { var e = this.ul.children.length; this.goto(this.index < e - 1 ? this.index + 1 : e ? 0 : -1) }, previous: function () { var e = this.ul.children.length, t = this.index - 1; this.goto(this.selected && -1 !== t ? t : e - 1) }, goto: function (e) { var t = this.ul.children; this.selected && t[this.index].setAttribute("aria-selected", "false"), this.index = e, e > -1 && t.length > 0 && (t[e].setAttribute("aria-selected", "true"), this.status.textContent = t[e].textContent, this.ul.scrollTop = t[e].offsetTop - this.ul.clientHeight + t[e].clientHeight, i.fire(this.input, "awesomplete-highlight", { text: this.suggestions[this.index] })) }, select: function (e, t) { if (e ? this.index = i.siblingIndex(e) : e = this.ul.children[this.index], e) { var s = this.suggestions[this.index]; i.fire(this.input, "awesomplete-select", { text: s, origin: t || e }) && (this.replace(s), this.close({ reason: "select" }), i.fire(this.input, "awesomplete-selectcomplete", { text: s })) } }, evaluate: function () { var t = this, i = this.input.value; i.length >= this.minChars && this._list.length > 0 ? (this.index = -1, this.ul.innerHTML = "", this.suggestions = this._list.map(function (s) { return new e(t.data(s, i)) }).filter(function (e) { return t.filter(e, i) }), !1 !== this.sort && (this.suggestions = this.suggestions.sort(this.sort)), this.suggestions = this.suggestions.slice(0, this.maxItems), this.suggestions.forEach(function (e) { t.ul.appendChild(t.item(e, i)) }), 0 === this.ul.children.length ? this.close({ reason: "nomatches" }) : this.open()) : this.close({ reason: "nomatches" }) } }, r.all = [], r.FILTER_CONTAINS = function (e, t) { return RegExp(i.regExpEscape(t.trim()), "i").test(e) }, r.FILTER_STARTSWITH = function (e, t) { return RegExp("^" + i.regExpEscape(t.trim()), "i").test(e) }, r.SORT_BYLENGTH = function (e, t) { return e.length !== t.length ? e.length - t.length : e < t ? -1 : 1 }, r.ITEM = function (e, t) { return i.create("li", { innerHTML: "" === t.trim() ? e : e.replace(RegExp(i.regExpEscape(t.trim()), "gi"), "<mark>$&</mark>"), "aria-selected": "false" }) }, r.REPLACE = function (e) { this.input.value = e.value }, r.DATA = function (e) { return e }, Object.defineProperty(e.prototype = Object.create(String.prototype), "length", { get: function () { return this.label.length } }), e.prototype.toString = e.prototype.valueOf = function () { return "" + this.label }; var o = Array.prototype.slice; i.create = function (e, t) { var s = document.createElement(e); for (var n in t) { var r = t[n]; if ("inside" === n) i(r).appendChild(s); else if ("around" === n) { var o = i(r); o.parentNode.insertBefore(s, o), s.appendChild(o) } else n in s ? s[n] = r : s.setAttribute(n, r) } return s }, i.bind = function (e, t) { if (e) for (var i in t) { var s = t[i]; i.split(/\s+/).forEach(function (t) { e.addEventListener(t, s) }) } }, i.unbind = function (e, t) { if (e) for (var i in t) { var s = t[i]; i.split(/\s+/).forEach(function (t) { e.removeEventListener(t, s) }) } }, i.fire = function (e, t, i) { var s = document.createEvent("HTMLEvents"); s.initEvent(t, !0, !0); for (var n in i) s[n] = i[n]; return e.dispatchEvent(s) }, i.regExpEscape = function (e) { return e.replace(/[-\\^$*+?.()|[\]{}]/g, "\\$&") }, i.siblingIndex = function (e) { for (var t = 0; e = e.previousElementSibling; t++); return t }, "undefined" != typeof Document && ("loading" !== document.readyState ? n() : document.addEventListener("DOMContentLoaded", n)), r.$ = i, r.$$ = s, "undefined" != typeof self && (self.Awesomplete = r), "object" == typeof module && module.exports && (module.exports = r) }(), AddyComplete.getParameterByName = function (e, t) { e = e.replace(/[\[\]]/g, "\\$&"); var i = new RegExp("[?&]" + e + "(=([^&#]*)|&|#|$)").exec(t); return i ? i[2] ? decodeURIComponent(i[2].replace(/\+/g, " ")) : "" : null }, AddyComplete.init = function () { for (var e = document.getElementsByTagName("script"), t = 0; t < e.length; t++) if (e[t].src && -1 !== e[t].src.toLowerCase().indexOf("addycomplete")) { this.apiKey = AddyComplete.getParameterByName("key", e[t].src), this.apiKey && "" != this.apiKey || console.warn("The API key is missing"); var i = this.getParameterByName("callback", e[t].src); return void (i && "function" == typeof window[i] && window[i]()) } }, AddyComplete.init();